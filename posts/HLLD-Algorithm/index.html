<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HLLD Algorithm | Robert 'Bob' Caddy</title><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="HLLD Algorithm" /><meta name="author" content="Robert Caddy" /><meta property="og:locale" content="en_US" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://robertcaddy.com/posts/HLLD-Algorithm/" /><meta property="og:url" content="https://robertcaddy.com/posts/HLLD-Algorithm/" /><meta property="og:site_name" content="Robert ‘Bob’ Caddy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-23T16:00:00-04:00" /> <script type="application/ld+json"> {"description":"Overview","author":{"@type":"Person","name":"Robert Caddy"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://robertcaddy.com/posts/HLLD-Algorithm/"},"@type":"BlogPosting","url":"https://robertcaddy.com/posts/HLLD-Algorithm/","headline":"HLLD Algorithm","dateModified":"2020-10-23T16:00:00-04:00","datePublished":"2020-10-23T16:00:00-04:00","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/icons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Robert 'Bob' Caddy</a></div><div class="site-subtitle font-italic">Ph.D Candidate, Third Year University of Pittsburgh</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-satellite-dish ml-xl-3 mr-xl-3 unloaded"></i> <span>RESEARCH BLOG</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/research/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-flask ml-xl-3 mr-xl-3 unloaded"></i> <span>RESEARCH</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/community-and-outreach/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-users ml-xl-3 mr-xl-3 unloaded"></i> <span>COMMUNITY & OUTREACH</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/contact/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-envelope ml-xl-3 mr-xl-3 unloaded"></i> <span>CONTACT</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/cv/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-scroll ml-xl-3 mr-xl-3 unloaded"></i> <span>CURRICULUM VITAE</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/resume/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-scroll ml-xl-3 mr-xl-3 unloaded"></i> <span>RESUME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/bcaddy" target="_blank"> <i class="fab fa-github"></i> </a> <a href=" javascript:window.open('mailto:' + ['r.caddy','pitt.edu'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/robertcaddy1/" target="_blank"> <i class="fab fa-linkedin"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HLLD Algorithm</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HLLD Algorithm</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Oct 23, 2020, 4:00 PM -0400" > Oct 23 <i class="unloaded">2020-10-23T16:00:00-04:00</i> </span> by <span class="author"> Robert Caddy </span></div><div> Updated <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 9, 2020, 4:04 PM -0500" > Nov 9 <i class="unloaded">2020-11-09T16:04:19-05:00</i> </span></div></div><div class="post-content"><h1 id="overview">Overview</h1><p>This is a step through of the HLLD Riemann solver I’m going to add to my <a href="https://github.com/bcaddy/hydro-sandbox">hydro-sandbox</a> code. The specific algorithm is from <a href="https://www.sciencedirect.com/science/article/pii/S0021999105001142?via%3Dihub">Miyoshi &amp; Kusano 2005</a> which is the original paper where the HLLD Riemann solver was introduced. This will serve as practice and figuring out any kinks before I add the HLLD solver (along with <a href="https://www.sciencedirect.com/science/article/abs/pii/S1384107608000754?via%3Dihub">VL+CT</a>) to <a href="https://github.com/cholla-hydro/cholla">Cholla</a>.</p><p>Overall the algorithm is very similar to the HLLC algorithm detailed in my <a href="/posts/HLLC-Algorithm/">earlier post on the topic</a>. However a lot of the details have changed; for example instead of the sound speed \( c \) we must now compute the speed of either the fast or slow magnetosonic wave \( c_{f,s} \). Similar small changes are common so be careful not to miss them. Note that the HLLD Riemann solver does not include all 7 MHD waves; It ignores the slow magnetosonic wave.</p><h2 id="glossary-of-symbols">Glossary of Symbols</h2><p>Note: since magnetic fields are inherently 3D due to the use of the outproduct even the 1D algorithm I write out here uses all three dimensions. The first dimension is always in the \( x \) direction however, again because of the cross product, the active elements of the magnetic field are in the \( y \) and \( z \) directions.</p><ul><li>\(k \), Subscript to indicate left or right. i.e. \( k = L \ \text{or}\ R \)</li><li>\(j \), Subscript to indicate which dimension we’re using. i.e. \( i = x, y, \text{or}\; z \)</li><li>\(* \), Superscript that indicates if the variable is the value within the star region, ie the region between the fast magnetosonic waves and the Alfvén waves.</li><li>\(** \), Superscript that indicates if the variable is the value within the star region, ie the region between the Alfvén waves and the contact discontinuity.</li><li>\( \vec{F} \), Flux</li><li>\(\rho \), Density</li><li>\(p \), Pressure</li><li>\(E \), Energy</li><li>\(v \), Velocity</li><li>\(B \), Magnetic Field</li><li>\(p_T \), Total pressure</li><li>\(S_L \), Approximation of the speed of the left moving magnetosonic wave</li><li>\(S_L^* \), Approximation of the speed of the left moving Alfvên wave</li><li>\(S_M \), Approximation of the speed of the center (contact) wave speed</li><li>\(S_R \), Approximation of the speed of the right moving magnetosonic wave</li><li>\(S_R^* \), Approximation of the speed of the right moving Alfvên wave</li><li>\(c \), Sound speed</li><li>\(\vec{U} \), Vector of conserved variables</li></ul><h2 id="glossary-of-new-equations">Glossary of New Equations</h2><p>MHD comes along with many modifications to the various basic equations that we’re used to; new terms in the pressure and energy equations, new wave speeds, new eigenvalues etc. I summarize the ones I plan to use here.</p><h3 id="conservative-variable-vector-and-flux">Conservative Variable Vector and Flux</h3>\[\vec{U}_k = \begin{bmatrix} \rho_k \\ \rho_k v_{x,k} \\ \rho_k v_{y,k} \\ \rho_k v_{z,k} \\ B_x \\ B_y \\ B_z \\ E \end{bmatrix} \text{,}\; \; \vec{F}_k = \begin{bmatrix} \rho_k v_{x,k} \\ \rho_k v_{x,k}^2 + p_{T,k} - B_{x,k}^2 \\ \rho v_{x,k} v_{y,k} - B_{x,k} B_{y,k} \\ \rho v_{x,k} v_{z,k} - B_{x,k} B_{z,k} \\ 0 \\ B_{y,k} v_{x,k} - B_{x,k} v_{y,k} \\ B_{z,k} v_{x,k} - B_{x,k} v_{z,k} \\ v_{x,k} \left( E_k + p_{T,k} \right) - B_{x,k} \left( \vec{v_k} \cdot \vec{B_k} \right) \end{bmatrix}\]<h3 id="eigenvalues">Eigenvalues:</h3>\[\lambda_{2,6} = v_x \mp c_a, \; \lambda_{1,7} = v_x \mp c_f, \; \lambda_{3,5} = v_x \mp c_s, \; \lambda_{4} = v_x\]<h3 id="alfvên-wave-speed">Alfvên Wave Speed:</h3>\[c_a = \frac{\mid B_x \mid}{\sqrt{\rho}}\]<h3 id="fast--slow-magnetosonic-wavespeeds">Fast &amp; Slow Magnetosonic Wavespeeds:</h3>\[c_{f,s} = \sqrt{\frac {\gamma p + \mid \vec{B} \mid^2 \pm \sqrt{\left( \gamma p \;+ \mid \vec{B} \mid^2 \right)^2 - 4\gamma p B_x^2 } } {2\rho}}\]<h3 id="pressure">Pressure:</h3>\[p = \left( \gamma - 1 \right) \left( E - \frac{1}{2} \rho \mid \vec{v}\mid ^2 - \frac{1}{2} \mid \vec{B} \mid ^2 \right)\] \[p_T = p_{Total} = p + \frac{1}{2} \mid \vec{B} \mid ^2\]<h3 id="energy">Energy:</h3>\[E = \frac{p}{\gamma - 1} + \frac{1}{2}\left( \rho \mid \vec{v} \mid ^2 + \mid \vec{B} \mid ^2\right) = \frac{p_T - \frac{1}{2}\mid \vec{B} \mid^2 }{\gamma - 1} + \frac{1}{2}\left( \rho \mid \vec{v} \mid ^2 + \mid \vec{B} \mid ^2\right)\]<h3 id="which-variables-are-the-same-between-states">Which Variables are the Same Between States:</h3>\[S_M = v_{x,L}^* = v_{x,L}^{**} = v_{x,R}^* = v_{x,R}^{**}\] \[p_T^* = p_{T_L}^* = p_{T_L}^{**} = p_{T_R}^* = p_{T_R}^{**}\] \[\rho_k^* = \rho_k^{**}\] \[\vec{v}_R^{**} = \vec{v}_L^{**} = \vec{v}^{**} \text{if}\; B_x = 0\] \[\vec{B}_R^{**} = \vec{B}_L^{**} = \vec{B}^{**}\; \text{if}\; B_x = 0\]<h1 id="algorithm">Algorithm</h1><p>Our goal is to choose the correct HLLD flux depending on the interface states.</p><h2 id="1-compute-acoustic--contact-wave-speeds">1. Compute Acoustic &amp; Contact Wave Speeds</h2><p>First we need to compute \( S_L, S_L^*, S_M, S_R^*, \text{and} S_R \) using the below equations.</p><h3 id="computing--s_l--and--s_r-">Computing \( S_L \) and \( S_R \)</h3><p>We can use either of the below approximations for \( S_L \text{and} S_R \) (there are other options as well, these were just the two given in <a href="https://www.sciencedirect.com/science/article/pii/S0021999105001142?via%3Dihub">Miyoshi &amp; Kusano 2005</a>)</p>\[S_L = \min(\lambda_{min}(\vec{U}_L), \lambda_{min}(\vec{U}_R))\] \[S_R = \max(\lambda_{max}(\vec{U}_L), \lambda_{max}(\vec{U}_R))\]<p>Where \( \lambda_{min} \) is the smallest eigenvalue and \( \lambda_{max} \) is the largest.</p><p><strong>OR</strong></p>\[S_L = \min(v_{x,L}, v_{x,R}) - \max(c_{f,L}, c_{f,R})\] \[S_R = \max(v_{x,L}, v_{x,R}) + \max(c_{f,L}, c_{f,R})\]<h3 id="computing--s_l--and--s_r--1">Computing \( S_L^* \) and \( S_R^* \)</h3>\[S_L^* = S_M - \frac{\mid B_x \mid}{\sqrt{\rho_L^*}}\] \[S_R^* = S_M + \frac{\mid B_x \mid}{\sqrt{\rho_R^*}}\]<p>where</p>\[\rho_k^* = \rho_k \frac{S_k - v_{x,k}}{S_k - S_M}\]<h3 id="computing--s_m-">Computing \( S_M \)</h3>\[S_M = \frac {\rho_R v_{x,R} \left( S_R - v_{x,R}\right) - \rho_L v_{x,L} \left( S_L - v_{x,L}\right) + p_{T_L} - p_{T_R}} {\rho_R \left( S_R - v_{x,R}\right) - \rho_L \left( S_L - v_{x,L}\right)}\]<h2 id="2-determine-which-state-were-in">2. Determine Which State We’re In</h2><p>Use the equation below with the wave speeds to determine which state we’re in. If we’re in a non-star state go to step 3a, for star states go to step 3b, and for double star states go to step 3c.</p>\[\vec{F}_{HLLC} = \begin{cases} \vec{F}_L &amp; \text{if}\ 0 &lt; S_L \\ \\ \vec{F}_L^* &amp; \text{if}\ S_L \leq 0 &lt; S_L^* \\ \\ \vec{F}_L^{**} &amp; \text{if}\ S_L^* \leq 0 &lt; S_M \\ \\ \vec{F}_R^{**} &amp; \text{if}\ S_M \leq 0 &lt; S_R^* \\ \\ \vec{F}_R^* &amp; \text{if}\ S_R^* \leq 0 \leq S_R \\ \\ \vec{F}_R &amp; \text{if}\ S_R &lt; 0 \end{cases}\]<h2 id="3-compute--return-the-fluxes">3. Compute &amp; Return the Fluxes</h2><h3 id="3a--f_l--or--f_r--state">3a. \( F_L \) or \( F_R \) State</h3><p>This is the region outside of either magnetosonic wave. The flux is easy, simply compute fluxes with the below equation and return.</p>\[\vec{F}_k = \begin{bmatrix} \rho_k v_{x,k} \\ \rho_k v_{x,k}^2 + p_{T,k} - B_{x,k}^2 \\ \rho v_{x,k} v_{y,k} - B_{x,k} B_{y,k} \\ \rho v_{x,k} v_{z,k} - B_{x,k} B_{z,k} \\ 0 \\ B_{y,k} v_{x,k} - B_{x,k} v_{y,k} \\ B_{z,k} v_{x,k} - B_{x,k} v_{z,k} \\ v_{x,k} \left( E_k + p_{T,k} \right) - B_{x,k} \left( \vec{v_k} \cdot \vec{B_k} \right) \end{bmatrix}\]<h3 id="3b--f_l--or--f_r--state">3b. \( F_L^* \) or \( F_R^* \) State</h3><p>This is the region between the fast magnetosonic waves and the Alfvên waves. These fluxes are more complicated and require the use of the fluxes from step 3a as well. The algorithm is exactly the same for the left and right star states so the subscript \( k \) is used to indicate \( R \) or \( L \).</p>\[\vec{F}_k^* = \vec{F}_k + S_k \left( \vec{U}_k^* - \vec{U}_k \right)\]<p>and we find the components of \(\vec{U}_k^* \) with the following equations. \( \rho^*_k \) was already computed when finding \( S_k^* \) and \( v_{x,k}^* = S_M \)</p>\[p_T^* = \frac { \rho_R p_{T_L} \left( S_R - v_{x,R} \right) - \rho_L p_{T_R} \left( S_L - v_{x,L} \right) + \rho_L \rho_R \left( S_R - v_{x,R} \right) \left( S_L - v_{x,L} \right) \left( v_{x,R} - v_{x,L} \right) } {\rho_R \left( S_R - v_{x,R} \right) - \rho_L \left( S_L - v_{x,L} \right)}\] \[E_k^* = \frac { E_k \left( S_k - v_{x,k} \right) - p_{T,k} v_{x,k} + p_T^* S_M + B_x \left( \vec{v}_k \cdot \vec{B}_k - \vec{v}_k^* \cdot \vec{B}_k^* \right) } {S_k - S_M}\]<p>We can find the \( y \) and \( z \) components of \( \vec{v} \) and \(\vec{B} \) with the follwing equations. Note these equations can give a term that is \( \frac{0}{0} \) if \( S_M = v_{x,k}\), \(S_k = v_{x,k} \pm c_{f,k}\), \(B_{y,k} = B_{z,k} = 0\), and \(B_x^2 \ge \gamma p_k \). If this is the case then there is no shock across \( S_k \), so set \( \vec{v}_k^* = \vec{v}_k\), \(B_{y,k} = B_{z,k} = 0\), \(\rho_k^* = \rho_k\), and \( p_{T,k}^* = p_{T,k} \).</p>\[v_{j,k}^* = v_{j,k} - B_x B_{j,k} \frac {S_M - v_{x,k}} {\rho_k \left( S_k - v_{x,k} \right) \left( S_k - S_M \right) - B_x^2 }\] \[B_{j,k}^* = B_{j,k} \frac {\rho_k \left( S_k - v_{x,k} \right)^2 - B_x^2 } {\rho_k \left( S_k - v_{x,k} \right) \left( S_k - S_M \right) - B_x^2 }\]<p>Note that the denominators are the same</p><h3 id="3c--f_l--or--f_r--state">3c. \( F_L^{**} \) or \( F_R^{**} \) State</h3><p>This is the region between the Alfvên waves and the contact discontinuity (entropy wave). These fluxes require the fluxes from step 3a and 3b. The algorithm is exactly the same for the left and right star states so the subscript \( k \) is used to indicate \( R \) or \( L \).</p>\[\vec{F}_k^{**} = \vec{F}_k^* + S_k^{**} \left( \vec{U}_k^{**} - \vec{U}_k^* \right)\]<p>We already know some of the state variables from previous computations</p>\[v_{x,k}^{**} = S_M\] \[p_T^{**} = p_T^{*}\] \[\rho_k^{**} = \rho_k^*\]<p>So all we need to compute directly is \( \; v_y^{**} \), \( \; v_z^{**} \), \( \; B_y^{**} \), \( \; B_z^{**} \), and \( \; E_k^{**} \)</p>\[v_j^{**} = \frac { v_L^* \sqrt{\rho_L^*} + v_R^* \sqrt{\rho_R^*} + \left( B_{j,R}^* - B_{j,L}^* \right) \text{sign}\left( B_x \right) } {\sqrt{\rho_L^*} + \sqrt{\rho_R^*}}\] \[B_j^{**} = \frac { B_{j,R}^* \sqrt{\rho_L^*} + B_{j,L}^* \sqrt{\rho_R^*} + \left( v_{j,R}^* - v_{j,L}^* \right) \sqrt{\rho_L^* \rho_R^*} \text{sign}\left( B_x \right) } {\sqrt{\rho_L^*} + \sqrt{\rho_R^*}}\]<p>Note that the denominators are the same as is one of the coefficients in each term in the numerator.</p><p>Lastly we compute the energy (the minus and plus correspond to the L and R side respectively)</p>\[E_k^{**} = E_k^* \mp \sqrt{\rho_k^*} \left( \vec{v}_k^* \cdot \vec{B}_k^* - \vec{v}_k^{**} \cdot \vec{B}_k^{**} \right) \text{sign}\left( B_x \right)\]<h1 id="conclusion">Conclusion</h1><p>And that’s it. We’re done! As you can see the HLLD solver is significantly more complex than the HLLC solver to account for the extra waves. Note that many of the star state primitive variables are used in a bunch of different places so assigning them to member variables is probably a good idea if you’re implementing this as a class.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/mhd/'>MHD</a>, <a href='/categories/riemann-solvers/'>Riemann Solvers</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hlld/" class="post-tag no-text-decoration" >HLLD</a> <a href="/tags/hllc/" class="post-tag no-text-decoration" >HLLC</a> <a href="/tags/mhd/" class="post-tag no-text-decoration" >MHD</a> <a href="/tags/hydro/" class="post-tag no-text-decoration" >Hydro</a> <a href="/tags/computational-methods/" class="post-tag no-text-decoration" >Computational Methods</a> <a href="/tags/numerical-methods/" class="post-tag no-text-decoration" >Numerical Methods</a> <a href="/tags/riemann-solver/" class="post-tag no-text-decoration" >Riemann Solver</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HLLD Algorithm - Robert 'Bob' Caddy&url=https://robertcaddy.com/posts/HLLD-Algorithm/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HLLD Algorithm - Robert 'Bob' Caddy&u=https://robertcaddy.com/posts/HLLD-Algorithm/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HLLD Algorithm - Robert 'Bob' Caddy&url=https://robertcaddy.com/posts/HLLD-Algorithm/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HLLD-Algorithm/">HLLD Algorithm</a></li><li><a href="/posts/HLLD-Implementation/">HLLD Implemention</a></li><li><a href="/posts/Starting-HLLD/">Starting On HLLD Riemann Solver</a></li><li><a href="/posts/HLLC-Algorithm/">HLLC Algorithm</a></li><li><a href="/posts/Starting-MHD/">Starting Magnetohydrodynamics (MHD)</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hlld/">HLLD</a> <a class="post-tag" href="/tags/mhd/">MHD</a> <a class="post-tag" href="/tags/computational-methods/">Computational Methods</a> <a class="post-tag" href="/tags/numerical-methods/">Numerical Methods</a> <a class="post-tag" href="/tags/hydro/">Hydro</a> <a class="post-tag" href="/tags/van-leer/">Van Leer</a> <a class="post-tag" href="/tags/hllc/">HLLC</a> <a class="post-tag" href="/tags/ctu/">CTU</a> <a class="post-tag" href="/tags/dotfiles/">dotfiles</a> <a class="post-tag" href="/tags/zingale/">Zingale</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HLLC-Algorithm/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 8 <i class="unloaded">2020-10-08T17:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HLLC Algorithm</h3><div class="text-muted small"><p> Overview This is a step through of the particular HLLC Riemann solver I’m going to add to my hydro-sandbox code. It will serve as a base and teaching tool for my future implementation of an HLLD M...</p></div></div></a></div><div class="card"> <a href="/posts/Research-So-Far/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Aug 31 <i class="unloaded">2020-08-31T11:12:26-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Research So Far</h3><div class="text-muted small"><p> Overview This is my first post so I’m going to summarize what I’ve done this year and what my plans are for the near future. I spent the spring semester mostly taking taking classes. When I had t...</p></div></div></a></div><div class="card"> <a href="/posts/More-MHD/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 25 <i class="unloaded">2020-09-25T15:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>More MHD</h3><div class="text-muted small"><p> General Relativity (GR) Started seriously on special relativity this week. Spent most of Monday on homework along with parts of Wednesday. Magnetohydrodynamics (MHD) Spent all of Tuesday and most ...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HLLC-Implementation/" class="btn btn-outline-primary"><p>HLLC Implementation</p></a> <a href="/posts/Starting-HLLD/" class="btn btn-outline-primary"><p>Starting On HLLD Riemann Solver</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://github.com/bcaddy">Robert Caddy</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme. Favicon by <a href="https://www.flaticon.com/authors/icongeek26">Icongeek26</a></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hlld/">HLLD</a> <a class="post-tag" href="/tags/mhd/">MHD</a> <a class="post-tag" href="/tags/computational-methods/">Computational Methods</a> <a class="post-tag" href="/tags/numerical-methods/">Numerical Methods</a> <a class="post-tag" href="/tags/hydro/">Hydro</a> <a class="post-tag" href="/tags/van-leer/">Van Leer</a> <a class="post-tag" href="/tags/hllc/">HLLC</a> <a class="post-tag" href="/tags/ctu/">CTU</a> <a class="post-tag" href="/tags/dotfiles/">dotfiles</a> <a class="post-tag" href="/tags/zingale/">Zingale</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://robertcaddy.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
